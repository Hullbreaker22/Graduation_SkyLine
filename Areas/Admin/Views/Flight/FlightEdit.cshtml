@model MixedClass

@{
    ViewData["Title"] = "Edit Flight";
}

@section Scripts {
    @if (@TempData["success-notification"] is not null)
    {
        <script>
            toastr.success('@TempData["success-notification"]')
        </script>
    }
    else if (@TempData["error-notification"] is not null)
    {
        <script>
            toastr.error('@TempData["error-notification"]')
        </script>
    }
}

<div class="container mt-4">
    <h2 class="mb-4">Edit Flight </h2>

    <form asp-action="FlightEdit" method="post" id="editForm">

        <input type="hidden" asp-for="@Model.flight.Flight_Id_PK" name="Flight_Id_PK" />

        <div class="row">

            <div class="col-md-6 mb-3">
                <label>Flight Code</label>
                <input asp-for="@Model.flight.Flight_Code" class="form-control" name="Flight_Code" />
            </div>

            <div class="col-md-6 mb-3">
                <label>Translate Code</label>
                <input asp-for="@Model.flight.Transate_FlightCode" class="form-control" name="Transate_FlightCode" />
            </div>

            <div class="col-md-6 mb-3">
                <label>Duration (Hours)</label>
                <input asp-for="@Model.flight.Duration" class="form-control" name="Duration" />
            </div>

            <div class="col-md-6 mb-3">
                <label>Price</label>
                <input asp-for="@Model.flight.Price" class="form-control" name="Price" />
            </div>

            <div class="col-md-6 mb-3">
                <label>Available Seats</label>
                <input asp-for="@Model.flight.AvailableSeats" class="form-control" name="AvailableSeats" />
            </div>

            <div class="col-md-6 mb-3">
                <label>Stop Points</label>
                <input asp-for="@Model.flight.StopPoints" class="form-control" name="StopPoints" />
            </div>

            <div class="col-md-6 mb-3">
                <label>Leaving Time</label>
                <input asp-for="@Model.flight.Leaving_Time" type="datetime-local" class="form-control" name="Leaving_Time" />
            </div>

            <div class="col-md-6 mb-3">
                <label>Arrival Time</label>
                <input asp-for="@Model.flight.Arriving_Time" type="datetime-local" class="form-control" name="Arriving_Time" />
            </div>

            <div class="col-md-6 mb-3">
                <label>Leaving Airport</label>
                <select asp-for="@Model.flight.Leaving_Airport_ID" class="form-select" name="Leaving_Airport_ID">
                    @foreach (var item in Model.airport)
                    {
                        <option value="@item.Id">@item.Name</option>
                    }
                </select>
            </div>

            <div class="col-md-6 mb-3">
                <label>Arrival Airport</label>
                <select asp-for="@Model.flight.Arrive_Airport_ID" class="form-select" name="Arrive_Airport_ID">
                    @foreach(var item in Model.airport)
                    {
                        <option value="@item.Id">@item.Name</option>                        
                    }

                </select>
            </div>

            <div class="col-md-6 mb-3">
                <label>AirLine</label>
                <select asp-for="@Model.flight.AirLine_ID" class="form-select" name="AirLine_ID">
                    @foreach (var item in Model.airline)
                    {
                        <option value="@item.Id">@item.Name</option>
                    }
                </select>
            </div>


        </div>

        <div class="mt-4 d-flex gap-3">

            <!-- Confirm Button -->
            <button type="button" onclick="confirmEdit()"
                    style="background:#0d6efd;color:white;padding:8px 16px;border-radius:6px;border:none;">
                ✅ Confirm
            </button>

            <!-- Cancel Button -->
            <a href="/Admin/Flight/Flights"
               style="background:#dc3545;color:white;padding:8px 16px;border-radius:6px;text-decoration:none;">
                ❌ Cancel
            </a>

        </div>

    </form>
</div>


<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    function confirmEdit() {
        Swal.fire({
            title: "Are you sure?",
            text: "Do you want to save the changes to this flight?",
            icon: "question",
            showCancelButton: true,
            confirmButtonColor: "#0d6efd",
            cancelButtonColor: "#dc3545",
            confirmButtonText: "Yes, Confirm ✅",
            cancelButtonText: "No, Cancel ❌"
        }).then((result) => {
            if (result.isConfirmed) {
                document.getElementById("editForm").submit();
            }
        });
    }
</script>
